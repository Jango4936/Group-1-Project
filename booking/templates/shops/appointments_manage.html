{% extends "shops/base_dashboard.html" %}
{% load static %}

{% block title %}Manage Appointments - EasyBook{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="dashboard-header">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2 class="text-white mb-1">Appointment Management</h2>
                    <p class="text-des">Manage all your appointments for {{ user.shop.name }}</p>
                </div>
                <div>
                    <a href="{% url 'booking:schedule' %}" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-2"></i>New Appointment
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Filter and Search Row -->
<div class="row mb-4">
    <div class="col-12">
        <div class="dashboard-card">
            <div class="dashboard-card-body">
                
              <form method="get" class="row g-3 align-items-end">

                <div class="col-md-4">
                  <label class="form-label text-light">Search</label>
                  <div class="input-group">
                    <span class="input-group-text bg-dark-card border-secondary">
                      <i class="bi bi-search text-muted"></i>
                    </span>
                    <input  type="text"
                            id="searchInput"
                            class="form-control"
                            name="q"
                            value="{{ request.GET.q }}"
                            placeholder="Customer, email, phone...">
                  </div>
                </div>

                <div class="col-md-2">
                  <label class="form-label text-light">Status</label>
                  <select  class="form-select"
                          name="status"
                          onchange="this.form.submit()">
                    <option value=""           {% if not request.GET.status %}selected{% endif %}>All</option>
                    <option value="confirmed"  {% if request.GET.status == 'confirmed' %}selected{% endif %}>Confirmed</option>
                    <option value="pending"    {% if request.GET.status == 'pending' %}selected{% endif %}>Pending</option>
                    <option value="completed"  {% if request.GET.status == 'completed' %}selected{% endif %}>Completed</option>
                    <option value="cancelled"  {% if request.GET.status == 'cancelled' %}selected{% endif %}>Cancelled</option>
                  </select>
                </div>

                <div class="col-md-2">
                  <label class="form-label text-light">Date Range</label>
                  <select class="form-select" name="range" onchange="this.form.submit()">
                    <option value="all"      {% if request.GET.range == 'all'      or not request.GET.range %}selected{% endif %}>All Time</option>
                    <option value="today"    {% if request.GET.range == 'today'    %}selected{% endif %}>Today</option>
                    <option value="week"     {% if request.GET.range == 'week'     %}selected{% endif %}>This Week</option>
                    <option value="month"    {% if request.GET.range == 'month'    %}selected{% endif %}>This Month</option>
                    <option value="upcoming" {% if request.GET.range == 'upcoming' %}selected{% endif %}>Upcoming</option>
                  </select>
                </div>

                <div class="col-md-2">
                  <label class="form-label text-light">Sort</label>
                  <select class="form-select" name="sort" onchange="this.form.submit()">
                    <option value="date_asc" {% if request.GET.sort == 'date_asc' or not request.GET.sort %}selected{% endif %}>
                        Date (Earliest)
                    </option>
                    <option value="date_desc" {% if request.GET.sort == 'date_desc' %}selected{% endif %}>
                        Date (Latest)
                    </option>
                    <option value="customer" {% if request.GET.sort == 'customer' %}selected{% endif %}>
                        Customer Name
                    </option>
                    <option value="status" {% if request.GET.sort == 'status' %}selected{% endif %}>
                        Status
                    </option>


                  </select>
                </div>

                <div class="col-md-2 d-grid">
                  <a href="{% url 'booking:appointments_manage' %}" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-clockwise me-1"></i>Clear</a>
                </div>
              </form>


            </div>
        </div>
    </div>
</div>

<!-- Appointments List -->
{% include "shops/_appointments_list.html" %}






{% endblock %}

{% block extra_js %}
<script src="{% static 'js/appointment_manage.js' %}"></script>
{% endblock %}
